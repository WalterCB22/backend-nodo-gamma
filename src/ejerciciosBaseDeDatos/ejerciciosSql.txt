#PUNTO 1 --- Mostras todos los registros de la tabla movies ---
SELECT * 
FROM movies;

#PUNTO 2 --- Mostrar el nombre, apellido y rating de todos los actores --- 
SELECT first_name, last_name, rating
FROM actors;

#PUNTO 3 --- Mostrar el título de todas las series ---
SELECT title
FROM series;

#PUNTO 4 --- Mostrar el nombre y apellido de los actores cuyo rating es mayor a 7,5 --- 
SELECT first_name, last_name, rating
FROM actors
WHERE rating > 7.5;

#PUNTO 5 --- Mostrar el título de las películas, el rating y los premios de las películas con un 
# rating mayor a 7.5 y con más de dos premios ---
SELECT title, rating, awards
FROM movies
WHERE rating > 7.5 AND awards > 2;

#PUNTO 6 --- Mostrar el título de las películas y el rating ordenadas por rating en forma ascendente ---
SELECT title, rating
FROM movies
ORDER BY rating ASC;

#PUNTO 7 --- Mostrar el título y el rating de todas las películas cuyo título incluya toy story ---
SELECT title, rating
FROM movies 
WHERE title LIKE "%Toy Story%";


#PUNTO 8 --- Mostrar todos los actores cuyo nombre empiezce con Sam ---
SELECT * 
FROM actors 
WHERE first_name LIKE "Sam%"; 

#PUNT0 9 --- Mostrar el título de las películas que salieron entre '2004-01-01' y '2008-12-31' ---
SELECT title, release_date
FROM movies
WHERE release_date BETWEEN '2004-01-01' AND '2008-12-31';

# Utilizando la base de datos de movies, queremos conocer, por un lado, los títulos y
# el nombre del género de todas las series de la base de datos.

SELECT s.title, genres.name
FROM series AS s
LEFT JOIN genres
ON s.genre_id = genres.id;

# Por otro lado, necesitamos listar los títulos de los episodios junto con el nombre y 
# apellido de los actores que trabajan en cada uno de ellos.

SELECT e.id, e.title,  actors.first_name, actors.last_name
FROM episodes as e
INNER JOIN actor_episode 
ON e.id = actor_episode.episode_id
INNER JOIN actors
ON actor_episode.actor_id = actors.id;

# Para nuestro próximo desafío, necesitamos obtener a todos los actores o actrices (mostrar nombre y apellido) 
# que su película favorita sea cualquiera de la saga de La Guerra de las Galaxias.

SELECT a.first_name, a.last_name, movies.title
FROM actors AS a
INNER JOIN movies
ON a.favorite_movie_id = movies.id #AND (a.favorite_movie_id = 3 OR a.favorite_movie_id = 4);
WHERE movies.title LIKE '%guerra de las galaxias%';


# Para nuestro próximo desafío, necesitamos obtener a todos los actores o actrices (mostrar nombre y apellido) 
# que han trabajado en cualquier película de la saga de La Guerra de las Galaxias.

SELECT DISTINCT actors.first_name, actors.last_name
FROM actor_movie AS a
INNER JOIN actors
ON a.actor_id = actors.id #AND (a.movie_id = 3 OR a.movie_id = 4)
INNER JOIN movies
ON a.movie_id = movies.id
WHERE movies.title LIKE '%guerra de las galaxias%';


# Crear un listado a partir de la tabla de películas, mostrar un reporte de la cantidad de películas por nombre de género.

SELECT genre_id, COUNT(genre_id) AS cantidad_de_películas_genero, genres.name
FROM movies
INNER JOIN genres
ON genres.id = movies.genre_id
GROUP BY genre_id;
